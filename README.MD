# User Management REST API

REST API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Spring Boot 3 –∏ PostgreSQL.

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Java 17**
- **Spring Boot 3.2.0**
- **PostgreSQL 15**
- **Liquibase** (–º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- **Spring Data JPA**
- **Spring Validation**
- **Spring Cache** (Caffeine)

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ UUID
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ UUID
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ @ControllerAdvice
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞
```git clone <your-repo-url>
cd user-api  
```   
mvn clean package
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL
```createdb userdb```

# –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ psql:
# CREATE DATABASE userdb;
3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```mvn spring-boot:run```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8080

üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü
sql
```CREATE TABLE roles (
    id UUID PRIMARY KEY,
    role_name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE users (
    id UUID PRIMARY KEY,
    fio VARCHAR(100) NOT NULL,
    phone_number VARCHAR(20) NOT NULL UNIQUE,
    avatar TEXT,
    role_id UUID NOT NULL REFERENCES roles(id)
);
````
–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–†–æ–ª—å: USER (UUID: a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11)

–†–æ–ª—å: ADMIN (UUID: b1eebc99-9c0b-4ef8-bb6d-6bb9bd380a12)

üì° API Endpoints
1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST /api/createNewUser

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
````{
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phoneNumber": "+79161234567",
    "avatar": "https://example.com/avatar.jpg",
    "roleName": "USER"
}
````
–û—Ç–≤–µ—Ç:
```{
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phoneNumber": "+79161234567",
    "avatar": "https://example.com/avatar.jpg",
    "roleName": "USER"
}
```
2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET /api/users?userID=123e4567-e89b-12d3-a456-426614174000
–û—Ç–≤–µ—Ç:
```
{
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phoneNumber": "+79161234567",
    "avatar": "https://example.com/avatar.jpg",
    "roleName": "USER"
}
```
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PUT /api/userDetailsUpdate?userID=123e4567-e89b-12d3-a456-426614174000
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```{
    "fio": "–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á",
    "phoneNumber": "+79169876543",
    "avatar": "https://example.com/new-avatar.jpg",
    "roleName": "ADMIN"
}
```
4. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
DELETE /api/users?userID=123e4567-e89b-12d3-a456-426614174000

–û—Ç–≤–µ—Ç: 204 No Content

‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (application.properties)

# Database
spring.datasource.url=jdbc:postgresql://localhost:5432/userdb
spring.datasource.username=postgres
spring.datasource.password=password
```
# JPA
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Liquibase
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.yaml

# Cache
spring.cache.type=caffeine
```
üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:

```
{
    "error": "User not found with id: 123e4567-e89b-12d3-a456-426614174000"
}
```
–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:

400 Bad Request - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

404 Not Found - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω

409 Conflict - —Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

500 Internal Server Error - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```
mvn test
```
–ü—Ä–∏–º–µ—Ä—ã curl –∑–∞–ø—Ä–æ—Å–æ–≤
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```
curl -X POST http://localhost:8080/api/createNewUser \
  -H "Content-Type: application/json" \
  -d '{
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phoneNumber": "+79161234567",
    "avatar": "https://example.com/avatar.jpg",
    "roleName": "USER"
  }'
  ```
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```curl -X GET "http://localhost:8080/api/users?userID=123e4567-e89b-12d3-a456-426614174000"```
üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

Spring Boot Starter Web

Spring Data JPA

PostgreSQL Driver

Liquibase Core

Spring Validation

Spring Cache

üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java 17

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Maven

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ IDE (IntelliJ IDEA —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
–ú–∏–≥—Ä–∞—Ü–∏–∏ Liquibase –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ ```src/main/resources/db/changelog/```

üìù –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã

MVC –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

REST best practices

–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö

–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
